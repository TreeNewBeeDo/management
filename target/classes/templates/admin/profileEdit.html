<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4" xmlns:width="http://www.w3.org/1999/xhtml"
      xmlns:hight="http://www.w3.org/1999/xhtml">
<head>
    <link rel="shortcut icon" href="/favicon.ico">
    <title>良 艺</title>
    <!-- Bootstrap core CSS -->
    <link href="../admins/css/bootstrap.min.css" rel="stylesheet">
    <link href="../admins/css/bootstrap-reset.css" rel="stylesheet">
    <!--external css-->
    <link href="../admins/assets/font-awesome/css/font-awesome.css" rel="stylesheet" />
    <link href="../admins/assets/jquery-easy-pie-chart/jquery.easy-pie-chart.css" rel="stylesheet" type="text/css" media="screen"/>
    <link rel="stylesheet" href="../admins/css/owl.carousel.css" type="text/css">
    <link rel="stylesheet" href="../admins/assets/data-tables/DT_bootstrap.css" />
    <!--right slidebar-->
    <link href="../admins/css/slidebars.css" rel="stylesheet">
    <!-- Cutom styles for this template -->
    <link href="../admins/css/style.css" rel="stylesheet">
    <link href="../admins/css/style-responsive.css" rel="stylesheet" />
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 tooltipss and media queries -->
    <script src="../admins/js/html5shiv.js"></script>
    <script src="../admins/js/respond.min.js"></script>

</head>

<body>

<section id="container" >
    <!--header start-->
    <header class="header white-bg">
        <div class="sidebar-toggle-box">
            <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
        </div>
        <!--logo start-->

        <a th:href="@{/login-allot}" class="logo">良<span>艺</span></a>

        <a class="logo">
            &nbsp;&nbsp;&nbsp;&nbsp;
            &nbsp;&nbsp&nbsp;&nbsp;
            良艺修理<span>日常管理系统
            </span>
        </a>
        <div class="top-nav ">
            <!--search & user info start-->
            <ul class="nav pull-right top-menu">
                <li class="dropdown">
                    <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                        <img th:src="'../update/portrait/'+${user.portraitUrl}" width="30px", hight="30px">
                        <span th:text="${user.name}" class="username" >Jhon Doue</span>
                        <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <div class="log-arrow-up"></div>
                        <li><a th:href="@{'/user/'+${user.userId}}" href="#"><i class=" fa fa-suitcase"></i>个人资料</a></li>
                        <!--<li><a href="#"><i class="fa fa-bell-o"></i> Notification</a></li>-->
                        <li><a th:href="@{/logout}"><i class="fa fa-key"></i> 注销</a></li>
                    </ul>
                </li>
            </ul>
            <!--search & user info end-->
        </div>
    </header>
    <!--header end-->
    <!--sidebar start-->
    <aside>
        <div id="sidebar"  class="nav-collapse ">
            <!-- sidebar menu start-->
            <ul class="sidebar-menu" id="nav-accordion">
                <li>
                    <a href="/adminIndex">
                        <i class="fa fa-dashboard"></i>
                        <span>仪表盘</span>
                    </a>
                </li>
                <li>
                    <a th:href="@{'/user/'+${user.userId}}">
                        <i class="fa fa-user"></i>
                        <span>个人资料</span>
                    </a>
                </li>
                <li class="sub-menu">
                    <a href="javascript:;" class="active">
                        <i class="fa fa-book"></i>
                        <span>用户管理</span>
                    </a>
                    <ul class="sub">
                        <li class="active><a th:href="@{/user/list}">普通用户</a></li>
                        <li><a th:href="@{/user/adminlist}" >管理员列表</a></li>
                    </ul>
                </li>

                <li class="sub-menu">
                    <a href="javascript:;" >
                        <i class="fa fa-th"></i>
                        <span>工具种类管理</span>
                    </a>
                    <ul class="sub">
                        <li><a  th:href="@{/category/list}">种类信息</a></li>
                        <li><a href="/category/addcategory?flag=1">增加工具种类</a></li>
                    </ul>
                </li>

                <li class="sub-menu">
                    <a href="javascript:;" >
                        <i class="fa fa-bar-chart-o"></i>
                        <span>工具管理</span>
                    </a>
                    <ul class="sub">
                        <li><a  th:href="@{/product/list}">工具列表</a></li>
                        <li><a  href="/product/addproduct?flag=1">增加工具</a></li>
                    </ul>
                </li>

                <li class="sub-menu">
                    <a href="javascript:;"  >
                        <i class="fa fa-bar-chart-o"></i>
                        <span>员工管理</span>
                    </a>
                    <ul class="sub">
                        <li ><a  th:href="@{/employee/list}">员工名单</a></li>
                        <li><a  href="/employee/addemployee?flag=1">增加人员</a></li>
<!--                        <li><a  href="/product/list">员工考勤情况</a></li>-->
                        <li><a  href="/employee/gradelist">员工工作评价（小本本）</a></li>
                        <li><a  href="/employee/addgrade?flag=1">添加员工工作评价</a></li>
                    </ul>
                </li>
                <li class="sub-menu">
                    <a href="javascript:;" >
                        <i class="fa fa-bar-chart-o"></i>
                        <span>业务管理</span>
                    </a>
                    <ul class="sub">
                        <li><a  href="/work/worklist">业务清单</a></li>
                        <li><a  href="/work/addwork?flag=1">新增业务记录</a></li>
                    </ul>
                </li>
                <li class="sub-menu">
                    <a href="javascript:;">
                        <i class="fa fa-bar-chart-o"></i>
                        <span>收支管理</span>
                    </a>
                    <ul class="sub">
                        <li ><a  href="/salary/list">流水账单</a></li>
                        <li ><a  href="/salary/addsalary?flag=1">新增账目</a></li>
                    </ul>
                </li>
                <li class="sub-menu">
                    <a href="javascript:;" >
                        <i class="fa fa-bar-chart-o"></i>
                        <span>客户信息管理</span>
                    </a>
                    <ul class="sub">
                        <li ><a  href="/client/vehiclelist">车主人员信息</a></li>
                        <li ><a  href="/client/carslist">车辆基本信息</a></li>
                        <li><a  href="/client/addvehicle?flag=1">新增车主记录</a></li>
                        <li><a  href="/client/addcars?flag=1">新增车辆记录</a></li>
                    </ul>
                </li>
            </ul>
            <!-- sidebar menu end-->
        </div>
    </aside>
    <!--sidebar end-->
    <!--main content start-->
    <section id="main-content">
        <section class="wrapper">
            <!-- page start-->
            <div class="row">
                <aside class="profile-nav col-lg-3">
                    <section class="panel">
                        <div class="user-heading round">
                            <a href="#">
                                <img th:src="@{'../update/portrait/'+${users.portraitUrl}}" alt="">
                            </a>
                            <h1 th:text="${users.name}">Jonathan Smith</h1>
                            <p th:text="${users.email}">jsmith@flatlab.com</p>
                            <form th:if="${user.userId} eq ${users.userId}" action="/user/updateImage" id="Picture" method="post"  enctype="multipart/form-data">
                                <input type="file" id="file" name="file" value="更换图片">
                                <button class="btn btn-success " onclick="pictureSubmit()" >提交</button>
                            </form>
                        </div>

                        <ul class="nav nav-pills nav-stacked">
                            <li><a th:href="@{'/user/'+${users.userId}}"> <i class="fa fa-user"></i> 个人资料</a></li>
                            <li class="active"><a th:href="@{'/user/toUserEdit?userId='+${users.userId}}" href="profile-edit.html"> <i class="fa fa-edit"></i> 修改个人资料</a></li>
                        </ul>

                    </section>
                </aside>
                <aside class="profile-info col-lg-9">
                    <section class="panel">
                        <div class="bio-graph-heading">
                            请在此处修改您的个人资料
                        </div>
                        <div class="panel-body bio-graph-info">
                            <h1> 个人资料</h1>
                            <form th:action="@{/user/updateUser}" th:method="post" id="formBase" class="form-horizontal" role="form">
                                <input type="hidden" name="userId" th:value="${users.userId}">
                                <div class="form-group">
                                    <label  class="col-lg-2 control-label">用户名</label>
                                    <div class="col-lg-6">
                                        <input readonly name="username" th:value="${users.username}" class="form-control">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label  class="col-lg-2 control-label">姓名</label>
                                    <div class="col-lg-6">
                                        <input type="text" name="name" th:value="${users.name}" class="form-control" maxlength="30" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label  class="col-lg-2 control-label">生日</label>
                                    <div class="col-lg-6">
                                        <input type="date" name="birth" th:value="${ds.format(users.birth)}" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label  class="col-lg-2 control-label">邮箱</label>
                                    <div class="col-lg-6">
                                        <input type="email" name="email" th:value="${users.email}" class="form-control"  required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label  class="col-lg-2 control-label">手机号</label>
                                    <div class="col-lg-6">
                                        <input type="number" name="phone" th:value="${users.phone}" class="form-control" maxlength="11" minlength="0">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label  class="col-lg-2 control-label">性别</label>
                                    <div class="col-lg-6">
                                        <select name="sex">
                                            <option th:switch="${users.sex}" th:value="${users.sex}">
                                                <a th:case="1">男</a>
                                                <a th:case="2">女</a>
                                                <a th:case="3">保密</a>
                                            </option>
                                            <option value="1">男</option>
                                            <option value="2">女</option>
                                            <option value="3">保密</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label  class="col-lg-2 control-label">地址</label>
                                    <div class="col-lg-6">
                                        <input type="text" name="address" th:value="${users.address}" class="form-control" placeholder=" ">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label  class="col-lg-2 control-label">邮编</label>
                                    <div class="col-lg-6">
                                        <input type="text" name="postcode" th:value="${users.postcode}" class="form-control" placeholder="">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label  class="col-lg-2 control-label">注册时间</label>
                                    <div class="col-lg-6">
                                        <a th:text="':'+${ds.format(users.registerTime)}">1998-03-12</a>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <div class="col-lg-offset-2 col-lg-10">
                                        <button type="submit" class="btn btn-success">提交</button>
                                        <!--<button type="button" class="btn btn-default">取消</button>-->
                                    </div>
                                </div>
                            </form>

                        </div>
                    </section>
                    <section>
                        <div class="panel panel-primary">
                            <div class="panel-heading"> 设置新密码</div>
                            <div class="panel-body">
                                <form th:action="@{/user/changePassword}" th:method="post" class="form-horizontal" id="form2" role="form">
                                    <input type="hidden" name="userId" th:value="${users.userId}">
                                    <div class="form-group">
                                        <label  class="col-lg-2 control-label">请输入原密码</label>
                                        <div class="col-lg-6">
                                            <input type="password" id="old_password" name="password" class="form-control" required>
                                            <span id="old_password_span"></span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label  class="col-lg-2 control-label">新密码</label>
                                        <div class="col-lg-6">
                                            <input type="password" id="newPassword" name="newPassword" class="form-control" required>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label  class="col-lg-2 control-label">请再次输入新密码</label>
                                        <div class="col-lg-6">
                                            <input type="password" id="reNewPassword" name="reNewPassword" class="form-control" required>
                                            <span id="reNewPassword_span">&nbsp;</span>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="col-lg-offset-2 col-lg-10">
                                            <button type="submit" class="btn btn-info">提交</button>
                                            <!--<button type="button" class="btn btn-default">Cancel</button>-->
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </section>
                </aside>
            </div>
            <!-- page end-->
        </section>
    </section>
    <!--main content end-->

    <!--footer start-->
    <footer class="site-footer">
        <div class="text-center">
            三屯营良艺修理厂管理系统2020年建。
            <a href="#" class="go-top">
                <i class="fa fa-angle-up"></i>
            </a>
        </div>
    </footer>
    <!--footer end-->
</section>

<!-- js placed at the end of the document so the pages load faster -->


<!--<script src="../admins/js/dist/jquery.js"></script>-->
<!--<script src="../admins/js/dist/jquery.validate.min.js"></script>-->
<!--<script src="../admins/js/dist/messages_zh.min.js"></script>-->
<script src="../admins/js/jquery.js"></script>
<script src="../admins/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../admins/assets/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script class="include" type="text/javascript" src="../admins/js/jquery.dcjqaccordion.2.7.js"></script>
<script src="../admins/js/jquery.scrollTo.min.js"></script>
<script src="../admins/js/jquery.nicescroll.js" type="text/javascript"></script>
<script src="../admins/assets/jquery-knob/js/jquery.knob.js"></script>
<script src="../admins/js/respond.min.js" ></script>
<!--这个页面的动画  需要它****-->
<script src="../admins/js/advanced-form-components.js"></script>
<!--right slidebar-->
<script src="../admins/js/slidebars.min.js"></script>

<!--common script for all pages-->
<script src="../admins/js/common-scripts.js"></script>

<script>
    //提交图片
    function pictureSubmit() {

        var Picture = document.getElementById("Picture");
        var file = document.getElementById("file").value;
        if (file == "" || file==null){
            alert("暂未选择图片");
        }
        else {
            Picture.submit;
        }

    }

    $("#old_password").change(function () {
        var oldPassword=$("#old_password").val();
        $.ajax({
            url:"/user/checkOldPassword",
            type:"POST",
            data:$(this).parents("form").serialize(),
            success:function (result) {
                if(result.code==0){
                    $("#old_password_span").attr("style","color:red;");
                    $("#form2").attr("flag1",0);
                }else{
                    $("#old_password_span").attr("style","");
                    $("#form2").attr("flag1",1);
                }
                $("#old_password_span").text(result.extend.checkResult);
            }
        });
    });

    $("#reNewPassword").change(function () {
        var newPassword=$("#newPassword").val();
        var reNewPassword=$("#reNewPassword").val();
        if(newPassword!=reNewPassword){
            $("#form2").attr("flag2",0);
            $("#reNewPassword_span").attr("style","color:red;");
            $("#reNewPassword_span").text("两次密码不一致");
        }else {
            $("#reNewPassword_span").attr("style","");
            $("#form2").attr("flag2",1);
            $("#reNewPassword_span").text("√");
        }
    });

    $("#form2").submit(function () {
        if($(this).attr("flag1")==1&&$(this).attr("flag2")==1){
            return true;
        }else
            return false;
    });


</script>

</body>
</html>
